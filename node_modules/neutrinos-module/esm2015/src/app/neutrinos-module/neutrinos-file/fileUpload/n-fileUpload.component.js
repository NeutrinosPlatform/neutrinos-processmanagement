import { __decorate } from "tslib";
import { Component, Input, Output, EventEmitter, ViewChild, Renderer2 } from '@angular/core';
import { NFileIOService } from '../services/n-fileIO.service';
let NFileUploadComponent = class NFileUploadComponent {
    constructor(fileIOService, _renderer) {
        this.fileIOService = fileIOService;
        this._renderer = _renderer;
        this.onsuccess = new EventEmitter();
        this.onerror = new EventEmitter();
    }
    /**
     * Method executed when upload button is clicked.
     */
    handleUpload() {
        this.isDone = false;
        if (this.file && this.uploadOptions && this.uploadOptions.entityName && this.uploadOptions.metadata) {
            this.fileIOService.upload({ files: this.file, entityName: this.uploadOptions.entityName, metadata: this.uploadOptions.metadata })
                .then((res) => {
                this.isDone = true;
                this.onsuccess.emit(res);
            })
                .catch(err => this.onerror.emit(err));
        }
        else {
            this.onerror.emit(new Error('Upload options missing'));
        }
    }
    /**
     * Method executed when a file is selected.
     */
    handleSelect(fileInput) {
        if (fileInput.target.files && fileInput.target.files[0]) {
            this.file = fileInput.target.files[0];
            this.fileName = this.file.name;
        }
    }
    /**
     * Methods executed when cancel button is clicked.
     * Clears files.
     */
    cancel() {
        this.file = null;
        this.fileName = null;
        this.isDone = false;
        // check if the file input is rendered before clearing it
        if (this.fileInput) {
            this._renderer.setProperty(this.fileInput, 'value', '');
        }
    }
    disableFileUploadButton() {
        if (typeof this.disableButton === 'boolean') {
            return this.disableButton;
        }
        return this.disableButton === 'disabled' || this.disableButton === 'true' ? true : false;
    }
};
NFileUploadComponent.ctorParameters = () => [
    { type: NFileIOService },
    { type: Renderer2 }
];
__decorate([
    ViewChild('fileInput', { static: false })
], NFileUploadComponent.prototype, "fileInput", void 0);
__decorate([
    Input()
], NFileUploadComponent.prototype, "uploadOptions", void 0);
__decorate([
    Input('disabled')
], NFileUploadComponent.prototype, "disableButton", void 0);
__decorate([
    Output()
], NFileUploadComponent.prototype, "onsuccess", void 0);
__decorate([
    Output()
], NFileUploadComponent.prototype, "onerror", void 0);
NFileUploadComponent = __decorate([
    Component({
        selector: 'n-file-upload',
        template: "<div>\r\n  <button mat-raised-button class=\"bh-file-upload\" (click)=\"fileInput.click()\" color=\"primary\"\r\n    *ngIf=\"!fileName\" [disabled]=\"disableFileUploadButton()\">\r\n    <mat-icon>attach_file</mat-icon>\r\n    <span>Choose a file...</span>\r\n    <input #fileInput type=\"file\" (change)=\"handleSelect($event)\" style=\"display:none;\" />\r\n  </button>\r\n  <div *ngIf=\"fileName\">\r\n    <button mat-raised-button color=\"primary\" (click)=\"handleUpload()\">\r\n      <mat-icon>file_upload</mat-icon>\r\n      <span>{{fileName}}</span>\r\n    </button>\r\n    <button *ngIf=\"!isDone\" mat-icon-button color=\"warn\" (click)=\"cancel()\" class=\"bh-file-upload-cancel\">\r\n      <mat-icon>cancel</mat-icon>\r\n    </button>\r\n    <button *ngIf=\"isDone\" mat-icon-button (click)=\"cancel()\" class=\"bh-file-upload-done\">\r\n      <mat-icon>done</mat-icon>\r\n    </button>\r\n  </div>\r\n</div>\r\n",
        styles: [".bh-file-upload{padding-left:8px;padding-right:8px}.bh-file-upload-cancel{height:24px;width:24px;position:relative;top:24px;left:-12px}::ng-deep [dir=rtl] .bh-file-upload-cancel{right:-12px;left:0}.bh-file-upload-cancel mat-icon{border-radius:12px;vertical-align:baseline}.bh-file-upload-done{height:24px;width:24px;position:relative;top:20px;left:-13px}::ng-deep [dir=rtl] .bh-file-upload-done{right:-12px;left:0}.bh-file-upload-done mat-icon{border-radius:12px;vertical-align:baseline}"]
    })
], NFileUploadComponent);
export { NFileUploadComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibi1maWxlVXBsb2FkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ldXRyaW5vcy1tb2R1bGUvIiwic291cmNlcyI6WyJzcmMvYXBwL25ldXRyaW5vcy1tb2R1bGUvbmV1dHJpbm9zLWZpbGUvZmlsZVVwbG9hZC9uLWZpbGVVcGxvYWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0YsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBUTlELElBQWEsb0JBQW9CLEdBQWpDLE1BQWEsb0JBQW9CO0lBVy9CLFlBQ1UsYUFBNkIsRUFDN0IsU0FBb0I7UUFEcEIsa0JBQWEsR0FBYixhQUFhLENBQWdCO1FBQzdCLGNBQVMsR0FBVCxTQUFTLENBQVc7UUFMcEIsY0FBUyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3ZELFlBQU8sR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztJQUk3QixDQUFDO0lBRW5DOztPQUVHO0lBQ0gsWUFBWTtRQUNWLElBQUksQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ3BCLElBQUksSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFO1lBQ25HLElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLEVBQUUsVUFBVSxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxDQUFDO2lCQUM5SCxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtnQkFDWixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztnQkFDbkIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDM0IsQ0FBQyxDQUFDO2lCQUNELEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDekM7YUFBTTtZQUNMLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQztTQUN4RDtJQUNILENBQUM7SUFFRDs7T0FFRztJQUNILFlBQVksQ0FBQyxTQUFjO1FBQ3pCLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDdkQsSUFBSSxDQUFDLElBQUksR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN0QyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ2hDO0lBQ0gsQ0FBQztJQUVEOzs7T0FHRztJQUNILE1BQU07UUFDSixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztRQUNqQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQztRQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQix5REFBeUQ7UUFDekQsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFO1lBQ2xCLElBQUksQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQ3pEO0lBQ0gsQ0FBQztJQUVELHVCQUF1QjtRQUNyQixJQUFJLE9BQU8sSUFBSSxDQUFDLGFBQWEsS0FBSyxTQUFTLEVBQUU7WUFDM0MsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDO1NBQzNCO1FBQ0QsT0FBTyxJQUFJLENBQUMsYUFBYSxLQUFLLFVBQVUsSUFBSSxJQUFJLENBQUMsYUFBYSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUM7SUFDM0YsQ0FBQztDQUVGLENBQUE7O1lBbkQwQixjQUFjO1lBQ2xCLFNBQVM7O0FBWlc7SUFBeEMsU0FBUyxDQUFDLFdBQVcsRUFBRSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQzt1REFBVztBQUsxQztJQUFSLEtBQUssRUFBRTsyREFBZTtBQUNKO0lBQWxCLEtBQUssQ0FBQyxVQUFVLENBQUM7MkRBQWU7QUFDdkI7SUFBVCxNQUFNLEVBQUU7dURBQXdEO0FBQ3ZEO0lBQVQsTUFBTSxFQUFFO3FEQUFzRDtBQVRwRCxvQkFBb0I7SUFMaEMsU0FBUyxDQUFDO1FBQ1QsUUFBUSxFQUFFLGVBQWU7UUFFekIsdTZCQUEyQzs7S0FDNUMsQ0FBQztHQUNXLG9CQUFvQixDQStEaEM7U0EvRFksb0JBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCwgUmVuZGVyZXIyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE5GaWxlSU9TZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvbi1maWxlSU8uc2VydmljZSc7XHJcblxyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICduLWZpbGUtdXBsb2FkJyxcclxuICBzdHlsZVVybHM6IFsnLi9uLWZpbGVVcGxvYWQuY29tcG9uZW50LnNjc3MnXSxcclxuICB0ZW1wbGF0ZVVybDogJy4vbi1maWxlVXBsb2FkLnRlbXBsYXRlLmh0bWwnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgTkZpbGVVcGxvYWRDb21wb25lbnQge1xyXG4gIEBWaWV3Q2hpbGQoJ2ZpbGVJbnB1dCcsIHtzdGF0aWM6IGZhbHNlfSkgZmlsZUlucHV0O1xyXG4gIGZpbGU6IEZpbGU7XHJcbiAgZmlsZU5hbWU7XHJcbiAgaXNEb25lOiBib29sZWFuO1xyXG5cclxuICBASW5wdXQoKSB1cGxvYWRPcHRpb25zO1xyXG4gIEBJbnB1dCgnZGlzYWJsZWQnKSBkaXNhYmxlQnV0dG9uO1xyXG4gIEBPdXRwdXQoKSBvbnN1Y2Nlc3M6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcbiAgQE91dHB1dCgpIG9uZXJyb3I6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBmaWxlSU9TZXJ2aWNlOiBORmlsZUlPU2VydmljZSxcclxuICAgIHByaXZhdGUgX3JlbmRlcmVyOiBSZW5kZXJlcjIpIHsgfVxyXG5cclxuICAvKipcclxuICAgKiBNZXRob2QgZXhlY3V0ZWQgd2hlbiB1cGxvYWQgYnV0dG9uIGlzIGNsaWNrZWQuXHJcbiAgICovXHJcbiAgaGFuZGxlVXBsb2FkKCk6IHZvaWQge1xyXG4gICAgdGhpcy5pc0RvbmUgPSBmYWxzZTtcclxuICAgIGlmICh0aGlzLmZpbGUgJiYgdGhpcy51cGxvYWRPcHRpb25zICYmIHRoaXMudXBsb2FkT3B0aW9ucy5lbnRpdHlOYW1lICYmIHRoaXMudXBsb2FkT3B0aW9ucy5tZXRhZGF0YSkge1xyXG4gICAgICB0aGlzLmZpbGVJT1NlcnZpY2UudXBsb2FkKHsgZmlsZXM6IHRoaXMuZmlsZSwgZW50aXR5TmFtZTogdGhpcy51cGxvYWRPcHRpb25zLmVudGl0eU5hbWUsIG1ldGFkYXRhOiB0aGlzLnVwbG9hZE9wdGlvbnMubWV0YWRhdGEgfSlcclxuICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmlzRG9uZSA9IHRydWU7XHJcbiAgICAgICAgICB0aGlzLm9uc3VjY2Vzcy5lbWl0KHJlcyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyID0+IHRoaXMub25lcnJvci5lbWl0KGVycikpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5vbmVycm9yLmVtaXQobmV3IEVycm9yKCdVcGxvYWQgb3B0aW9ucyBtaXNzaW5nJykpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWV0aG9kIGV4ZWN1dGVkIHdoZW4gYSBmaWxlIGlzIHNlbGVjdGVkLlxyXG4gICAqL1xyXG4gIGhhbmRsZVNlbGVjdChmaWxlSW5wdXQ6IGFueSk6IHZvaWQge1xyXG4gICAgaWYgKGZpbGVJbnB1dC50YXJnZXQuZmlsZXMgJiYgZmlsZUlucHV0LnRhcmdldC5maWxlc1swXSkge1xyXG4gICAgICB0aGlzLmZpbGUgPSBmaWxlSW5wdXQudGFyZ2V0LmZpbGVzWzBdO1xyXG4gICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5maWxlLm5hbWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBNZXRob2RzIGV4ZWN1dGVkIHdoZW4gY2FuY2VsIGJ1dHRvbiBpcyBjbGlja2VkLlxyXG4gICAqIENsZWFycyBmaWxlcy5cclxuICAgKi9cclxuICBjYW5jZWwoKTogdm9pZCB7XHJcbiAgICB0aGlzLmZpbGUgPSBudWxsO1xyXG4gICAgdGhpcy5maWxlTmFtZSA9IG51bGw7XHJcbiAgICB0aGlzLmlzRG9uZSA9IGZhbHNlO1xyXG4gICAgLy8gY2hlY2sgaWYgdGhlIGZpbGUgaW5wdXQgaXMgcmVuZGVyZWQgYmVmb3JlIGNsZWFyaW5nIGl0XHJcbiAgICBpZiAodGhpcy5maWxlSW5wdXQpIHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0UHJvcGVydHkodGhpcy5maWxlSW5wdXQsICd2YWx1ZScsICcnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRpc2FibGVGaWxlVXBsb2FkQnV0dG9uKCkge1xyXG4gICAgaWYgKHR5cGVvZiB0aGlzLmRpc2FibGVCdXR0b24gPT09ICdib29sZWFuJykge1xyXG4gICAgICByZXR1cm4gdGhpcy5kaXNhYmxlQnV0dG9uO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZGlzYWJsZUJ1dHRvbiA9PT0gJ2Rpc2FibGVkJyB8fCB0aGlzLmRpc2FibGVCdXR0b24gPT09ICd0cnVlJyA/IHRydWUgOiBmYWxzZTtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==