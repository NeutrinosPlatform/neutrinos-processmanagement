/**
 * @fileoverview added by tsickle
 * Generated from: lib/neutrinos-oauth-client.module.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { NgModule, APP_INITIALIZER } from '@angular/core';
import { NeutrinosOauthComponent } from './neutrinos-oauth.component';
import { HttpClientModule, HTTP_INTERCEPTORS } from '@angular/common/http';
import { CookieInterceptorService } from './cookie-interceptor.service';
import { NeutrinosOAuthClientService } from './neutrinos-oauth-client.service';
import { UtilService } from './services/util.service';
/**
 * @param {?} neutrinosOAuthService
 * @param {?} utilService
 * @return {?}
 */
export function getTokens(neutrinosOAuthService, utilService) {
    return (/**
     * @return {?}
     */
    () => {
        /**
         * For ios restore the cookies and get userInfo since iOS webview does not
         * persisit the cookie between app launches
         */
        if (utilService.getEnvValue('isIDSEnabled') === 'true') {
            if (window['device'] && window['device'].platform === 'iOS') {
                return neutrinosOAuthService.restoreCookies().then((/**
                 * @param {?} cookieExist
                 * @return {?}
                 */
                (cookieExist) => {
                    console.log('cookieExist' + cookieExist);
                    cookieExist ? neutrinosOAuthService.getUserInfo()
                        .catch((/**
                     * @param {?} userInfoErr
                     * @return {?}
                     */
                    userInfoErr => {
                        console.log(userInfoErr);
                    })) : null;
                }));
            }
            else {
                // Cannot get cookie for cross domain using JS. hence calling userinfo always
                return neutrinosOAuthService.getUserInfo()
                    .catch((/**
                 * @param {?} userInfoErr
                 * @return {?}
                 */
                userInfoErr => {
                    console.log(userInfoErr);
                }));
            }
        }
    });
}
// @dynamic (https://github.com/ng-packagr/ng-packagr/issues/641)
export class NeutrinosOAuthClientModule {
}
NeutrinosOAuthClientModule.decorators = [
    { type: NgModule, args: [{
                declarations: [NeutrinosOauthComponent],
                imports: [
                    HttpClientModule
                ],
                providers: [
                    {
                        provide: HTTP_INTERCEPTORS,
                        useClass: CookieInterceptorService,
                        multi: true
                    },
                    {
                        provide: APP_INITIALIZER,
                        useFactory: getTokens,
                        deps: [NeutrinosOAuthClientService, UtilService],
                        multi: true
                    },
                ]
            },] }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmV1dHJpbm9zLW9hdXRoLWNsaWVudC5tb2R1bGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZXV0cmlub3Mtb2F1dGgtY2xpZW50LyIsInNvdXJjZXMiOlsibGliL25ldXRyaW5vcy1vYXV0aC1jbGllbnQubW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxlQUFlLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDMUQsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDdEUsT0FBTyxFQUFFLGdCQUFnQixFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDM0UsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDeEUsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDL0UsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHlCQUF5QixDQUFDOzs7Ozs7QUFFdEQsTUFBTSxVQUFVLFNBQVMsQ0FBQyxxQkFBa0QsRUFBRSxXQUF3QjtJQUNwRzs7O0lBQU8sR0FBRyxFQUFFO1FBQ1Y7OztXQUdHO1FBQ0gsSUFBSSxXQUFXLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxLQUFLLE1BQU0sRUFBRTtZQUN0RCxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsUUFBUSxLQUFLLEtBQUssRUFBRztnQkFDNUQsT0FBTyxxQkFBcUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxJQUFJOzs7O2dCQUFDLENBQUMsV0FBVyxFQUFFLEVBQUU7b0JBQ2pFLE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxHQUFHLFdBQVcsQ0FBQyxDQUFDO29CQUN6QyxXQUFXLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLFdBQVcsRUFBRTt5QkFDaEQsS0FBSzs7OztvQkFBQyxXQUFXLENBQUMsRUFBRTt3QkFDbkIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztvQkFDM0IsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztnQkFDWixDQUFDLEVBQUMsQ0FBQzthQUNKO2lCQUFNO2dCQUNMLDZFQUE2RTtnQkFDN0UsT0FBTyxxQkFBcUIsQ0FBQyxXQUFXLEVBQUU7cUJBQ3pDLEtBQUs7Ozs7Z0JBQUMsV0FBVyxDQUFDLEVBQUU7b0JBQ25CLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBQzNCLENBQUMsRUFBQyxDQUFDO2FBQ0o7U0FDRjtJQUNILENBQUMsRUFBQztBQUNKLENBQUM7O0FBc0JELE1BQU0sT0FBTywwQkFBMEI7OztZQW5CdEMsUUFBUSxTQUFDO2dCQUNSLFlBQVksRUFBRSxDQUFDLHVCQUF1QixDQUFDO2dCQUN2QyxPQUFPLEVBQUU7b0JBQ1AsZ0JBQWdCO2lCQUNqQjtnQkFDRCxTQUFTLEVBQUU7b0JBQ1Q7d0JBQ0UsT0FBTyxFQUFFLGlCQUFpQjt3QkFDMUIsUUFBUSxFQUFFLHdCQUF3Qjt3QkFDbEMsS0FBSyxFQUFFLElBQUk7cUJBQ1o7b0JBQ0Q7d0JBQ0UsT0FBTyxFQUFFLGVBQWU7d0JBQ3hCLFVBQVUsRUFBRSxTQUFTO3dCQUNyQixJQUFJLEVBQUUsQ0FBQywyQkFBMkIsRUFBRSxXQUFXLENBQUM7d0JBQ2hELEtBQUssRUFBRSxJQUFJO3FCQUNaO2lCQUNGO2FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZ01vZHVsZSwgQVBQX0lOSVRJQUxJWkVSIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE5ldXRyaW5vc09hdXRoQ29tcG9uZW50IH0gZnJvbSAnLi9uZXV0cmlub3Mtb2F1dGguY29tcG9uZW50JztcclxuaW1wb3J0IHsgSHR0cENsaWVudE1vZHVsZSwgSFRUUF9JTlRFUkNFUFRPUlMgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XHJcbmltcG9ydCB7IENvb2tpZUludGVyY2VwdG9yU2VydmljZSB9IGZyb20gJy4vY29va2llLWludGVyY2VwdG9yLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBOZXV0cmlub3NPQXV0aENsaWVudFNlcnZpY2UgfSBmcm9tICcuL25ldXRyaW5vcy1vYXV0aC1jbGllbnQuc2VydmljZSc7XHJcbmltcG9ydCB7IFV0aWxTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy91dGlsLnNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VucyhuZXV0cmlub3NPQXV0aFNlcnZpY2U6IE5ldXRyaW5vc09BdXRoQ2xpZW50U2VydmljZSwgdXRpbFNlcnZpY2U6IFV0aWxTZXJ2aWNlKSB7XHJcbiAgcmV0dXJuICgpID0+IHtcclxuICAgIC8qKlxyXG4gICAgICogRm9yIGlvcyByZXN0b3JlIHRoZSBjb29raWVzIGFuZCBnZXQgdXNlckluZm8gc2luY2UgaU9TIHdlYnZpZXcgZG9lcyBub3RcclxuICAgICAqIHBlcnNpc2l0IHRoZSBjb29raWUgYmV0d2VlbiBhcHAgbGF1bmNoZXNcclxuICAgICAqL1xyXG4gICAgaWYgKHV0aWxTZXJ2aWNlLmdldEVudlZhbHVlKCdpc0lEU0VuYWJsZWQnKSA9PT0gJ3RydWUnKSB7XHJcbiAgICAgIGlmICh3aW5kb3dbJ2RldmljZSddICYmIHdpbmRvd1snZGV2aWNlJ10ucGxhdGZvcm0gPT09ICdpT1MnICkge1xyXG4gICAgICAgIHJldHVybiBuZXV0cmlub3NPQXV0aFNlcnZpY2UucmVzdG9yZUNvb2tpZXMoKS50aGVuKChjb29raWVFeGlzdCkgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ2Nvb2tpZUV4aXN0JyArIGNvb2tpZUV4aXN0KTtcclxuICAgICAgICAgIGNvb2tpZUV4aXN0ID8gbmV1dHJpbm9zT0F1dGhTZXJ2aWNlLmdldFVzZXJJbmZvKClcclxuICAgICAgICAgIC5jYXRjaCh1c2VySW5mb0VyciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXJJbmZvRXJyKTtcclxuICAgICAgICAgIH0pIDogbnVsbDtcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBDYW5ub3QgZ2V0IGNvb2tpZSBmb3IgY3Jvc3MgZG9tYWluIHVzaW5nIEpTLiBoZW5jZSBjYWxsaW5nIHVzZXJpbmZvIGFsd2F5c1xyXG4gICAgICAgIHJldHVybiBuZXV0cmlub3NPQXV0aFNlcnZpY2UuZ2V0VXNlckluZm8oKVxyXG4gICAgICAgIC5jYXRjaCh1c2VySW5mb0VyciA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyh1c2VySW5mb0Vycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG4vLyBAZHluYW1pYyAoaHR0cHM6Ly9naXRodWIuY29tL25nLXBhY2thZ3IvbmctcGFja2Fnci9pc3N1ZXMvNjQxKVxyXG5ATmdNb2R1bGUoe1xyXG4gIGRlY2xhcmF0aW9uczogW05ldXRyaW5vc09hdXRoQ29tcG9uZW50XSxcclxuICBpbXBvcnRzOiBbXHJcbiAgICBIdHRwQ2xpZW50TW9kdWxlXHJcbiAgXSxcclxuICBwcm92aWRlcnM6IFtcclxuICAgIHtcclxuICAgICAgcHJvdmlkZTogSFRUUF9JTlRFUkNFUFRPUlMsXHJcbiAgICAgIHVzZUNsYXNzOiBDb29raWVJbnRlcmNlcHRvclNlcnZpY2UsXHJcbiAgICAgIG11bHRpOiB0cnVlXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBwcm92aWRlOiBBUFBfSU5JVElBTElaRVIsXHJcbiAgICAgIHVzZUZhY3Rvcnk6IGdldFRva2VucyxcclxuICAgICAgZGVwczogW05ldXRyaW5vc09BdXRoQ2xpZW50U2VydmljZSwgVXRpbFNlcnZpY2VdLFxyXG4gICAgICBtdWx0aTogdHJ1ZVxyXG4gICAgfSxcclxuICBdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZXV0cmlub3NPQXV0aENsaWVudE1vZHVsZSB7IH1cclxuIl19