import * as platform from 'platform';
// @dynamic
export class NSystemService {
    constructor() {
        this._deviceType = this.checkDevice();
    }
    static getInstance() {
        if (!this.instance) {
            this.instance = new NSystemService();
        }
        return this.instance;
    }
    /**
     * Seter and getter for the environments
     */
    // set environments(properties) {
    //   console.log(properties);
    //   NSystemService.envProperties = properties;
    //   this.properties = this.getVal('properties');
    // }
    // get environments() {
    //   return NSystemService.envProperties;
    // }
    /**
     * Returna 'mobile' or 'browser' based on the platform
     */
    checkDevice() {
        if (window['device'] && (window['device']['platform'] != 'browser' || window['device']['platform'] != 'Browser')) {
            return 'mobile';
        }
        else if (window['device'] && (window['device']['platform'] == 'browser' || window['device']['platform'] == 'Browser')) {
            return 'cordova_browser';
        }
        else {
            return 'browser';
        }
    }
    get deviceType() {
        return this._deviceType;
    }
    getVal(key) {
        if (!NSystemService.envProperties) {
            NSystemService.envProperties = window['neutrinos']['environments'];
            this.properties = NSystemService.envProperties.properties;
        }
        if (key == 'properties') {
            if (NSystemService.envProperties) {
                return NSystemService.envProperties.properties;
            }
            else {
                return undefined;
            }
        }
        else {
            if (NSystemService.envProperties && NSystemService.envProperties.properties) {
                return NSystemService.envProperties.properties[key];
            }
            else {
                return undefined;
            }
        }
    }
    isAndroid() {
        if (window['device'] && window['device']['platform'] == 'Android') {
            return true;
        }
        else {
            return false;
        }
    }
    isIOS() {
        if (window['device'] && window['device']['platform'] == 'iOS') {
            return true;
        }
        else {
            return false;
        }
    }
    getAndroidVersion() {
        if (this.isAndroid()) {
            return window['device']['version'];
        }
        else {
            return '';
        }
    }
    getAuthUrl() {
        // this.properties = this.getVal('properties');
        return this.properties.baseUrl + this.properties.tenantName + '/auth/';
    }
    getTenantUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/';
    }
    getAppUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/' + this.properties.appName + '/';
    }
    getProxyUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/proxy/';
    }
    getDataModelUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/datamodel/' + this.properties.appDataSource + '/' + this.properties.appName + '/';
    }
    getFileIOUrl() {
        return this.properties.baseUrl + this.properties.tenantName + '/fileio/' +
            this.properties.appDataSource + '/' + this.properties.appName + '/';
    }
    getPlatformDetails(type) {
        const pDetails = {
            platform: platform.os.family,
            platformVersion: platform.os.version,
        };
        if (type === 'browser') {
            return Object.assign(pDetails, {
                type: 'browser',
                browser: platform.name,
                browserVersion: platform.version,
            });
        }
        else if (type === 'mobile' || type === 'cordova_browser') {
            return Object.assign(pDetails, {
                type: 'mobile',
                model: window['device'].model,
                manufacturer: window['device'].manufacturer,
                isVirtual: window['device'].isVirtual
            });
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibi1zeXN0ZW0uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25ldXRyaW5vcy1zZWVkLXNlcnZpY2VzLyIsInNvdXJjZXMiOlsic3JjL2FwcC9uZXV0cmlub3Mtc2VlZC1zZXJ2aWNlcy9uLXN5c3RlbS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sS0FBSyxRQUFRLE1BQU0sVUFBVSxDQUFDO0FBRXJDLFdBQVc7QUFDWCxNQUFNLE9BQU8sY0FBYztJQWV6QjtRQUNFLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBQ3hDLENBQUM7SUFURCxNQUFNLENBQUMsV0FBVztRQUNoQixJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNsQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksY0FBYyxFQUFFLENBQUM7U0FDdEM7UUFDRCxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUM7SUFDdkIsQ0FBQztJQU1EOztPQUVHO0lBRUgsaUNBQWlDO0lBQ2pDLDZCQUE2QjtJQUM3QiwrQ0FBK0M7SUFDL0MsaURBQWlEO0lBQ2pELElBQUk7SUFFSix1QkFBdUI7SUFDdkIseUNBQXlDO0lBQ3pDLElBQUk7SUFFSjs7T0FFRztJQUNILFdBQVc7UUFDVCxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxTQUFTLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFNBQVMsQ0FBQyxFQUFFO1lBQ2hILE9BQU8sUUFBUSxDQUFDO1NBQ2pCO2FBQU0sSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksU0FBUyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxTQUFTLENBQUMsRUFBRTtZQUN2SCxPQUFPLGlCQUFpQixDQUFDO1NBQzFCO2FBQU07WUFDTCxPQUFPLFNBQVMsQ0FBQztTQUNsQjtJQUNILENBQUM7SUFHRCxJQUFXLFVBQVU7UUFDbkIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzFCLENBQUM7SUFJTSxNQUFNLENBQUMsR0FBRztRQUNmLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxFQUFFO1lBQ2pDLGNBQWMsQ0FBQyxhQUFhLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ25FLElBQUksQ0FBQyxVQUFVLEdBQUcsY0FBYyxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUM7U0FDM0Q7UUFFRCxJQUFJLEdBQUcsSUFBSSxZQUFZLEVBQUU7WUFDdkIsSUFBSSxjQUFjLENBQUMsYUFBYSxFQUFFO2dCQUNoQyxPQUFPLGNBQWMsQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDO2FBQ2hEO2lCQUFNO2dCQUNMLE9BQU8sU0FBUyxDQUFDO2FBQ2xCO1NBQ0Y7YUFBTTtZQUNMLElBQUksY0FBYyxDQUFDLGFBQWEsSUFBSSxjQUFjLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRTtnQkFDM0UsT0FBTyxjQUFjLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNyRDtpQkFBTTtnQkFDTCxPQUFPLFNBQVMsQ0FBQzthQUNsQjtTQUVGO0lBRUgsQ0FBQztJQUVNLFNBQVM7UUFDZCxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLElBQUksU0FBUyxFQUFFO1lBQ2pFLE9BQU8sSUFBSSxDQUFDO1NBQ2I7YUFBTTtZQUNMLE9BQU8sS0FBSyxDQUFDO1NBQ2Q7SUFDSCxDQUFDO0lBRU0sS0FBSztRQUNWLElBQUksTUFBTSxDQUFDLFFBQVEsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxLQUFLLEVBQUU7WUFDN0QsT0FBTyxJQUFJLENBQUM7U0FDYjthQUFNO1lBQ0wsT0FBTyxLQUFLLENBQUM7U0FDZDtJQUNILENBQUM7SUFFTSxpQkFBaUI7UUFDdEIsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLEVBQUU7WUFDcEIsT0FBTyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDcEM7YUFBTTtZQUNMLE9BQU8sRUFBRSxDQUFDO1NBQ1g7SUFDSCxDQUFDO0lBRU0sVUFBVTtRQUNmLCtDQUErQztRQUMvQyxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxHQUFHLFFBQVEsQ0FBQztJQUN6RSxDQUFDO0lBQ00sWUFBWTtRQUNqQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxHQUFHLEdBQUcsQ0FBQztJQUNwRSxDQUFDO0lBRU0sU0FBUztRQUNkLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEdBQUcsU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLEdBQUcsQ0FBQztJQUMxRyxDQUFDO0lBRU0sV0FBVztRQUNoQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztJQUMxRSxDQUFDO0lBRU0sZUFBZTtRQUNwQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxHQUFHLGFBQWEsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO0lBQ3BKLENBQUM7SUFFTSxZQUFZO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxVQUFVLEdBQUcsVUFBVTtZQUN0RSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLEdBQUcsR0FBRyxDQUFDO0lBQ3hFLENBQUM7SUFFTSxrQkFBa0IsQ0FBQyxJQUFJO1FBQzVCLE1BQU0sUUFBUSxHQUFHO1lBQ2YsUUFBUSxFQUFFLFFBQVEsQ0FBQyxFQUFFLENBQUMsTUFBTTtZQUM1QixlQUFlLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQyxPQUFPO1NBQ3JDLENBQUM7UUFDRixJQUFJLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDdEIsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRTtnQkFDN0IsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLFFBQVEsQ0FBQyxJQUFJO2dCQUN0QixjQUFjLEVBQUUsUUFBUSxDQUFDLE9BQU87YUFDakMsQ0FBQyxDQUFDO1NBQ0o7YUFBTSxJQUFJLElBQUksS0FBSyxRQUFRLElBQUksSUFBSSxLQUFLLGlCQUFpQixFQUFFO1lBQzFELE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUU7Z0JBQzdCLElBQUksRUFBRSxRQUFRO2dCQUNkLEtBQUssRUFBRSxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsS0FBSztnQkFDN0IsWUFBWSxFQUFFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxZQUFZO2dCQUMzQyxTQUFTLEVBQUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFNBQVM7YUFDdEMsQ0FBQyxDQUFDO1NBQ0o7SUFDSCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gJy4uLy4uL2Vudmlyb25tZW50cy9lbnZpcm9ubWVudCc7XHJcbmltcG9ydCB7IE5VdGlsaXR5IH0gZnJvbSAnLi9uLXV0aWwuc2VydmljZSc7XHJcbmltcG9ydCB7IE5Mb2NhbFN0b3JhZ2VTZXJ2aWNlIH0gZnJvbSAnLi9uLWxvY2FsU3RvcmFnZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgKiBhcyBwbGF0Zm9ybSBmcm9tICdwbGF0Zm9ybSc7XHJcblxyXG4vLyBAZHluYW1pY1xyXG5leHBvcnQgY2xhc3MgTlN5c3RlbVNlcnZpY2Uge1xyXG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBOU3lzdGVtU2VydmljZTtcclxuXHJcbiAgcHJpdmF0ZSBfZGV2aWNlVHlwZTogc3RyaW5nO1xyXG4gIC8vIHByaXZhdGUgX2RldmljZVVVSUQ7XHJcbiAgdXVpZDtcclxuICBwcm9wZXJ0aWVzO1xyXG4gIHN0YXRpYyBlbnZQcm9wZXJ0aWVzO1xyXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgIGlmICghdGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICB0aGlzLmluc3RhbmNlID0gbmV3IE5TeXN0ZW1TZXJ2aWNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLl9kZXZpY2VUeXBlID0gdGhpcy5jaGVja0RldmljZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU2V0ZXIgYW5kIGdldHRlciBmb3IgdGhlIGVudmlyb25tZW50c1xyXG4gICAqL1xyXG5cclxuICAvLyBzZXQgZW52aXJvbm1lbnRzKHByb3BlcnRpZXMpIHtcclxuICAvLyAgIGNvbnNvbGUubG9nKHByb3BlcnRpZXMpO1xyXG4gIC8vICAgTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcyA9IHByb3BlcnRpZXM7XHJcbiAgLy8gICB0aGlzLnByb3BlcnRpZXMgPSB0aGlzLmdldFZhbCgncHJvcGVydGllcycpO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gZ2V0IGVudmlyb25tZW50cygpIHtcclxuICAvLyAgIHJldHVybiBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzO1xyXG4gIC8vIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJuYSAnbW9iaWxlJyBvciAnYnJvd3NlcicgYmFzZWQgb24gdGhlIHBsYXRmb3JtXHJcbiAgICovXHJcbiAgY2hlY2tEZXZpY2UoKTogc3RyaW5nIHtcclxuICAgIGlmICh3aW5kb3dbJ2RldmljZSddICYmICh3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddICE9ICdicm93c2VyJyB8fCB3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddICE9ICdCcm93c2VyJykpIHtcclxuICAgICAgcmV0dXJuICdtb2JpbGUnO1xyXG4gICAgfSBlbHNlIGlmICh3aW5kb3dbJ2RldmljZSddICYmICh3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddID09ICdicm93c2VyJyB8fCB3aW5kb3dbJ2RldmljZSddWydwbGF0Zm9ybSddID09ICdCcm93c2VyJykpIHtcclxuICAgICAgcmV0dXJuICdjb3Jkb3ZhX2Jyb3dzZXInO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuICdicm93c2VyJztcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuICBwdWJsaWMgZ2V0IGRldmljZVR5cGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fZGV2aWNlVHlwZTtcclxuICB9XHJcblxyXG5cclxuXHJcbiAgcHVibGljIGdldFZhbChrZXkpIHtcclxuICAgIGlmICghTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcykge1xyXG4gICAgICBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzID0gd2luZG93WyduZXV0cmlub3MnXVsnZW52aXJvbm1lbnRzJ107XHJcbiAgICAgIHRoaXMucHJvcGVydGllcyA9IE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllcztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoa2V5ID09ICdwcm9wZXJ0aWVzJykge1xyXG4gICAgICBpZiAoTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcykge1xyXG4gICAgICAgIHJldHVybiBOU3lzdGVtU2VydmljZS5lbnZQcm9wZXJ0aWVzLnByb3BlcnRpZXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMgJiYgTlN5c3RlbVNlcnZpY2UuZW52UHJvcGVydGllcy5wcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgcmV0dXJuIE5TeXN0ZW1TZXJ2aWNlLmVudlByb3BlcnRpZXMucHJvcGVydGllc1trZXldO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIGlzQW5kcm9pZCgpIHtcclxuICAgIGlmICh3aW5kb3dbJ2RldmljZSddICYmIHdpbmRvd1snZGV2aWNlJ11bJ3BsYXRmb3JtJ10gPT0gJ0FuZHJvaWQnKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGlzSU9TKCkge1xyXG4gICAgaWYgKHdpbmRvd1snZGV2aWNlJ10gJiYgd2luZG93WydkZXZpY2UnXVsncGxhdGZvcm0nXSA9PSAnaU9TJykge1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRBbmRyb2lkVmVyc2lvbigpIHtcclxuICAgIGlmICh0aGlzLmlzQW5kcm9pZCgpKSB7XHJcbiAgICAgIHJldHVybiB3aW5kb3dbJ2RldmljZSddWyd2ZXJzaW9uJ107XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0QXV0aFVybCgpIHtcclxuICAgIC8vIHRoaXMucHJvcGVydGllcyA9IHRoaXMuZ2V0VmFsKCdwcm9wZXJ0aWVzJyk7XHJcbiAgICByZXR1cm4gdGhpcy5wcm9wZXJ0aWVzLmJhc2VVcmwgKyB0aGlzLnByb3BlcnRpZXMudGVuYW50TmFtZSArICcvYXV0aC8nO1xyXG4gIH1cclxuICBwdWJsaWMgZ2V0VGVuYW50VXJsKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnLyc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0QXBwVXJsKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL3Byb3h5LycgKyB0aGlzLnByb3BlcnRpZXMuYXBwTmFtZSArICcvJztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRQcm94eVVybCgpIHtcclxuICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYmFzZVVybCArIHRoaXMucHJvcGVydGllcy50ZW5hbnROYW1lICsgJy9wcm94eS8nO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGdldERhdGFNb2RlbFVybCgpIHtcclxuICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXMuYmFzZVVybCArIHRoaXMucHJvcGVydGllcy50ZW5hbnROYW1lICsgJy9kYXRhbW9kZWwvJyArIHRoaXMucHJvcGVydGllcy5hcHBEYXRhU291cmNlICsgJy8nICsgdGhpcy5wcm9wZXJ0aWVzLmFwcE5hbWUgKyAnLyc7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0RmlsZUlPVXJsKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucHJvcGVydGllcy5iYXNlVXJsICsgdGhpcy5wcm9wZXJ0aWVzLnRlbmFudE5hbWUgKyAnL2ZpbGVpby8nICtcclxuICAgICAgdGhpcy5wcm9wZXJ0aWVzLmFwcERhdGFTb3VyY2UgKyAnLycgKyB0aGlzLnByb3BlcnRpZXMuYXBwTmFtZSArICcvJztcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRQbGF0Zm9ybURldGFpbHModHlwZSkge1xyXG4gICAgY29uc3QgcERldGFpbHMgPSB7XHJcbiAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybS5vcy5mYW1pbHksXHJcbiAgICAgIHBsYXRmb3JtVmVyc2lvbjogcGxhdGZvcm0ub3MudmVyc2lvbixcclxuICAgIH07XHJcbiAgICBpZiAodHlwZSA9PT0gJ2Jyb3dzZXInKSB7XHJcbiAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHBEZXRhaWxzLCB7XHJcbiAgICAgICAgdHlwZTogJ2Jyb3dzZXInLFxyXG4gICAgICAgIGJyb3dzZXI6IHBsYXRmb3JtLm5hbWUsXHJcbiAgICAgICAgYnJvd3NlclZlcnNpb246IHBsYXRmb3JtLnZlcnNpb24sXHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnbW9iaWxlJyB8fCB0eXBlID09PSAnY29yZG92YV9icm93c2VyJykge1xyXG4gICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihwRGV0YWlscywge1xyXG4gICAgICAgIHR5cGU6ICdtb2JpbGUnLFxyXG4gICAgICAgIG1vZGVsOiB3aW5kb3dbJ2RldmljZSddLm1vZGVsLFxyXG4gICAgICAgIG1hbnVmYWN0dXJlcjogd2luZG93WydkZXZpY2UnXS5tYW51ZmFjdHVyZXIsXHJcbiAgICAgICAgaXNWaXJ0dWFsOiB3aW5kb3dbJ2RldmljZSddLmlzVmlydHVhbFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIl19